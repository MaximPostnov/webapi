<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
    <title>Домашняя страница</title>
    <link rel="stylesheet" href="CSS/style.css" type="text/css" media="all" />
    <link rel="stylesheet" href="CSS/Setka.css" type="text/css"/>
    <!--[if lte IE 6]><link rel="stylesheet" href="css/ie6.css" type="text/css" media="all" /><![endif]-->

    <meta name="keywwords" content="Shop Around - Great free html template for on-line shop. Use it as a start point for your on line business. The template can be easily implemented in many open source E-commerce platforms" />
    <meta name="description" content="Shop Around - Great free html template for on-line shop. Use it as a start point for your on line business. The template can be easily implemented in many open source E-commerce platforms" />

    <!-- JS -->
    <script src="js/jquery-1.4.1.min.js" type="text/javascript"></script>
    <script src="js/jquery.jcarousel.pack.js" type="text/javascript"></script>
    <script src="js/jquery-func.js" type="text/javascript"></script>
    <!-- End JS -->
    
    <style>
        .shell {
            background: #fff;
            width: 100%;
            padding: 0px;
        }
        #content {
            float: left;
            width: 1005px;
            padding: 10px;
            position: relative
        }
        #sidebar {
            float: left;
            width: 226px;
            padding:10px;

        }
        #cart {
            float: right;
            width: 220px;
            top: 0;
            right: 0;
            height: 51px;
            background: #19c819;
            color: #fff;
            padding: 13px 10px 0 10px;
            white-space: nowrap;
            line-height: 20px;
        }

        #profile {
            float: right;
            width: 220px;
            top: 0;
            right: 0;
            height: 51px;
            background: #19c819;
            color: #fff;
            padding: 13px 10px 0 10px;
            white-space: nowrap;
            line-height: 20px;
        }


        .overlay {
            background: #000;
            position: fixed;
            left: 0;
            right: 0;
            top: 0;
            bottom: 0;
            z-index: 1000;
            opacity: .5;
        }

        .visible {
            background: #fff;
            position: fixed;
            left: 50%;
            top: 50%;
            margin-top: -200px;
            overflow: hidden;
            z-index: 2000;
            width: 300px;
            padding: 0px;
            margin-left: -100px;
        }

        #closeBt {
            float: right;
            line-height: 20px;
            margin: 1.2em;
            border: none;
            background: transparent;
            color: blue;
        }

            #win button[type="button"]:hover {
                cursor: pointer;
                color: navy;
                text-decoration: underline;
            }

        #win h3 {
            text-align: center;
            color: #555;
        }

        .contentmodal {
            padding: 0 1em;
            border-top: 1px solid #ccc;
            border-bottom: 1px solid #ccc;
            background: WhiteSmoke;
        }
        .butAuth {
            font-weight: 200;
            color: white;
            text-decoration: none;
            padding: 3px;
            border-radius: 3px;
            background: rgb(64,199,129);
            box-shadow: 0 -3px rgb(53,167,110) inset;
            transition: 0.2s;
        }
            .butAuth:hover {
                background: rgb(53, 167, 110);
            }
            .butAuth:active {
                background: rgb(33,147,90);
                box-shadow: 0 3px rgb(33,147,90) inset;
            }
    </style>
</head>
<body>

    <!-- Shell -->
    <div class="shell">

        <!-- Header -->
        <div id="header">
            <h1 id="logo"><a href="homepage.html">ЛОГО</a></h1>

            <div id="profile">
                <div id="profileId" style="display:none;"></div>
                <div id="msgAuth"></div>
                <div class="cl">&nbsp;</div>
                <button class="butAuth" onClick="getElementById('win').removeAttribute('style');" type="button">Авторизоваться</button>
                &nbsp;&nbsp;
                <span><button class="butAuth" type="button" id="loginOut" name="loginOut">Выйти </button></span>
            </div>

            <!---Modal details-->
            <div id="win" style="display:none;">
                <div class="overlay"></div>
                <div class="visible">
                    <h2>Авторизация</h2>
                    <div class="contentmodal">
                        <div>
                            <label for="">Email: </label><br />
                            <input type="text" id="Email" name="Email" />
                        </div>
                        <div>
                            <label for="">Пароль: </label><br />
                            <input type="password" id="Password" name="Password" />
                        </div>
                        <div>
                            <label for=""> </label><br />
                            <button type="button" id="loginBtn" name="loginBtn" onClick="getElementById('win').style.display='none';">Авторизоваться </button>
                            <label for=""> </label><br />
                            <a href="../Register.html">Регистрация</a>
                        </div>
                    </div>

                    <button id="closeBt" type="button" onClick="getElementById('win').style.display='none';">закрыть</button>
                </div>
            </div>
            <!--End Modal details-->
            <!-- Cart -->
            <div id="cart">
                <a href="cart.html" class="cart-link">Корзина</a>
                
            </div>
            <!-- End Cart -->
            <!-- Navigation -->
            <div id="navigation">
                <ul>
                    <li><a href="#" class="active">Ссылка1</a></li>
                    <li><a href="#">Ссылка2</a></li>
                    <li><a href="#">Ссылка3</a></li>
                    <li><a href="#">Ссылка4</a></li>
                    <li><a href="#">Ссылка5</a></li>
                </ul>
            </div>
            <!-- End Navigation -->



        </div>
        <!-- End Header -->
        <!-- Main -->
        <div id="main">
            <div class="cl">&nbsp;</div>

            <!-- Sidebar -->
            <div id="sidebar">
                <!-- Categories -->
                <div class="box categories">
                    <h2>Категории <span></span></h2>
                    <div class="box-content">
                        <ul>
                            <li><a href="#">Категория 1</a></li>
                            <li><a href="#">Категория 2</a></li>
                            <li><a href="#">Категория 3</a></li>
                            <li><a href="#">Категория 4</a></li>
                            <li><a href="#">Категория 5</a></li>
                        </ul>
                    </div>
                </div>
                <!-- End Categories -->

            </div>
            <!-- End Sidebar -->
            <!-- Content -->
            <div id="content">

                <!-- Content Slider -->
                <div id="slider" class="box">
                    <div id="slider-holder">
                        <ul>
                            <li><a href="#"><img src="../images/слайды/1.bmp" alt="" /></a></li>
                            <li><a href="#"><img src="../images/слайды/2.bmp" alt="" /></a></li>
                            <li><a href="#"><img src="../images/слайды/3.bmp" alt="" /></a></li>
                            <li><a href="#"><img src="../images/слайды/4.bmp" alt="" /></a></li>
                        </ul>
                    </div>
                    <div id="slider-nav">
                        <a href="#" class="active">1</a>
                        <a href="#">2</a>
                        <a href="#">3</a>
                        <a href="#">4</a>
                    </div>
                </div>
                <ul class="products_clearfix"></ul>



                <!-- End Content Slider -->
                <!-- Products -->
                <!--<div class="products">
            <div class="cl">&nbsp;</div>
            <ul>
                <li>
                    <a href="#"><img src="css/Images/big1.jpg" alt="" /></a>
                    <div class="product-info">
                        <h3>LOREM IPSUM</h3>
                        <div class="product-desc">
                            <h4>WOMEN’S</h4>
                            <p>Lorem ipsum dolor sit<br />amet</p>
                            <strong class="price">$58.99</strong>
                        </div>
                    </div>
                </li>
                <li>
                    <a href="#"><img src="css/Images/big1.jpg" alt="" /></a>
                    <div class="product-info">
                        <h3>LOREM IPSUM</h3>
                        <div class="product-desc">
                            <h4>WOMEN’S</h4>
                            <p>Lorem ipsum dolor sit<br />amet</p>
                            <strong class="price">$58.99</strong>
                        </div>
                    </div>
                </li>
                <li class="last">
                    <a href="#"><img src="css/Images/big1.jpg" alt="" /></a>
                    <div class="product-info">
                        <h3>LOREM IPSUM</h3>
                        <div class="product-desc">
                            <h4>WOMEN’S</h4>
                            <p>Lorem ipsum dolor sit<br />amet</p>
                            <strong class="price">$58.99</strong>
                        </div>
                    </div>
                </li>
            </ul>
            <div class="cl">&nbsp;</div>
        </div>-->
                <!-- End Products -->

            </div>
            <!-- End Content -->


            <div class="cl">&nbsp;</div>
        </div>
        <!-- End Main -->
        <!-- Side Full -->
        <div class="side-full">

            <!-- More Products -->
            <!--<div class="more-products">
                <div class="more-products-holder">
                    <ul>
                        <li><a href="#"><img src="css/Images/small1.jpg" alt="" /></a></li>
                        <li><a href="#"><img src="css/Images/small2.jpg" alt="" /></a></li>
                        <li><a href="#"><img src="css/Images/small3.jpg" alt="" /></a></li>
                        <li><a href="#"><img src="css/Images/small4.jpg" alt="" /></a></li>
                        <li><a href="#"><img src="css/Images/small5.jpg" alt="" /></a></li>
                        <li><a href="#"><img src="css/Images/small6.jpg" alt="" /></a></li>
                        <li><a href="#"><img src="css/Images/small7.jpg" alt="" /></a></li>
                        <li><a href="#"><img src="css/Images/small1.jpg" alt="" /></a></li>
                        <li><a href="#"><img src="css/Images/small2.jpg" alt="" /></a></li>
                        <li><a href="#"><img src="css/Images/small3.jpg" alt="" /></a></li>
                        <li><a href="#"><img src="css/Images/small4.jpg" alt="" /></a></li>
                        <li><a href="#"><img src="css/Images/small5.jpg" alt="" /></a></li>
                        <li><a href="#"><img src="css/Images/small6.jpg" alt="" /></a></li>
                        <li><a href="#"><img src="css/Images/small7.jpg" alt="" /></a></li>
                        <li><a href="#"><img src="css/Images/small1.jpg" alt="" /></a></li>
                        <li><a href="#"><img src="css/Images/small2.jpg" alt="" /></a></li>
                        <li><a href="#"><img src="css/Images/small3.jpg" alt="" /></a></li>
                        <li><a href="#"><img src="css/Images/small4.jpg" alt="" /></a></li>
                        <li><a href="#"><img src="css/Images/small5.jpg" alt="" /></a></li>
                        <li><a href="#"><img src="css/Images/small6.jpg" alt="" /></a></li>
                        <li class="last"><a href="#"><img src="css/Images/small7.jpg" alt="" /></a></li>
                    </ul>
                </div>
                <div class="more-nav">
                    <a href="#" class="prev">previous</a>
                    <a href="#" class="next">next</a>
                </div>
            </div>-->
            <!-- End More Products -->
            <!-- Text Cols -->
            <!--<div class="cols">
                <div class="cl">&nbsp;</div>
                <div class="col">
                    <h3 class="ico ico1">Donec imperdiet</h3>
                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec imperdiet, metus ac cursus auctor, arcu felis ornare dui.</p>
                    <p class="more"><a href="#" class="bul">Lorem ipsum</a></p>
                </div>
                <div class="col">
                    <h3 class="ico ico2">Donec imperdiet</h3>
                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec imperdiet, metus ac cursus auctor, arcu felis ornare dui.</p>
                    <p class="more"><a href="#" class="bul">Lorem ipsum</a></p>
                </div>
                <div class="col">
                    <h3 class="ico ico3">Donec imperdiet</h3>
                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec imperdiet, metus ac cursus auctor, arcu felis ornare dui.</p>
                    <p class="more"><a href="#" class="bul">Lorem ipsum</a></p>
                </div>
                <div class="col col-last">
                    <h3 class="ico ico4">Donec imperdiet</h3>
                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec imperdiet, metus ac cursus auctor, arcu felis ornare dui.</p>
                    <p class="more"><a href="#" class="bul">Lorem ipsum</a></p>
                </div>
                <div class="cl">&nbsp;</div>
            </div>-->
            <!-- End Text Cols -->

        </div>
        <!-- End Side Full -->
        <!-- Footer -->
        <div id="footer">
            <p class="left">
                <a href="#">Ссылка1</a>
                <span>|</span>
                <a href="#">Ссылка2</a>
                <span>|</span>
                <a href="#">Ссылка3</a>
                <span>|</span>
                <a href="#">Ссылка4</a>
                <span>|</span>
                <a href="#">Ссылка5</a>
            </p>
            <p class="right">
                &copy; 2018 ИГЭУ.
                Разработал <a href="№" target="_blank" title="ПОСТНОВ">Разработчик</a>
            </p>
        </div>
        <!-- End Footer -->
    </div>
    <!-- End Shell -->

    <!--<script src="https://code.jquery.com/jquery-2.2.4.min.js"
            integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="
            crossorigin="anonymous"></script>

    <script>
        $(document).ready(function () {
            $('.layout-buttons span').click(function () {
                var $elem = $(this);
                var $productList = $('.products');
                $elem.toggleClass('active');
                $elem.siblings().toggleClass('active');
                $productList.toggleClass('table-layout');
            });
        });
    </script>-->

    <script>
        

        // Получение всех пользователей
        function GetUsers() {
            $.ajax({
                url: '/api/orderobjects',
                type: 'GET',
                contentType: "application/json",
                success: function (orderobjects) {
                    var rows = "";
                    $.each(orderobjects, function (index, orderobject) {
                        // добавляем полученные элементы в таблицу
                        rows += row(orderobject);
                    })
                    $(".products_clearfix").append(rows);
                }
            });
        }
        // создание строки для таблицы
        var row = function (orderobject) {
            return "<li class='product-wrapper'>" +
                "<a href='' class='product'>" +
                "<div class='product-main'>" +
                "<div class='product-photo'>" +
                "<img src='../images/Товары/" + orderobject.image +"' alt='Фото отсутствует'>" +
                //"<img src=" + orderobject.image + " alt='Фото отсутствует'>" +
                "</div>" +
                "<div class='product-text'>" +
                "<h2 class='produvt-name'>" + orderobject.name + "</h2>" +
                //<p>Удобрение</p>

                "</div>" +
                "</div>" +
                "<div class='product-details-wrap'>" +
                "<div class='product-details'>" +
                "<div class='product-availability'>В наличии: " + orderobject.availability + "</div>" +
                "<div class='product-type'>Тип: " + orderobject.type.name + "</div>" +
                "<div class='product-manufacturer'>Производитель: " + orderobject.manufacturer.name +"</div>" +
                "<span class='product-price product-price-old'>" +
                "<b>" + (orderobject.price + 100) + "</b>" +
                "<small>руб.</small>" +
                "</span>" +
                "<span class='product-price'>" +
                "<b>" + orderobject.price + "</b>" +
                "<small>руб.</small>" +
                "</span>" +
                "</div>" +
                "<div class='product-buttons-wrap'>" +
                "<div class='buttons'>" +
                "<span class='button to-cart' onclick='AddToCart(" + orderobject.objectId + ")' >В корзину</span>" +
                "</div>" +
                " </div>" +
                "</div>" +
                "</a>" +
                "</li>";




            //"<tr data-rowid='" + orderobject.objectId + "'>" +
            //    "<td>" + orderobject.objectId + "</td>" +
            //    "<td>" + orderobject.name + "</td>" +
            //    "<td>" + orderobject.price + "</td>" +
            //    "<td>" + orderobject.availability + "</td>" +
            //    "<td>" + orderobject.manufacturer.name + "</td>" +
            //    "<td>" + orderobject.type.name + "</td>" +
            //    "<td>" + orderobject.type.name + "</td>" +


            //    "<td><button class='editLink' data-id='" + orderobject.objectId + "'>Изменить</button> | " +
            //    "<button class='removeLink' data-id='" + orderobject.objectId + "'>Удалить</button></td></tr>";
        }


        // загрузка пользователей
        GetUsers();
    </script>


    <script>
        
        //Выход из профиля 
        function LogOff() {
            var xmlhttp = new XMLHttpRequest();
            xmlhttp.open("POST", "/api/Account/LogOff", true); //http://localhost:13807

            xmlhttp.onreadystatechange = function () {
                document.getElementById("msgAuth").innerHTML = "Вы гость."
                //document.getElementById("loginButton").innerHTML = "<a class='btn btn-outline' href='#' data-toggle='modal' data-target='#autorizModal'>Войти</a>";
            }
            xmlhttp.send();
        }

        //function LogIN() {
        //    ParseResponseMsg();
        //    GetCurrentUser();
        //}

        // Обработка клика по кнопке
        //document.getElementById("loginBtn").addEventListener("click", LogIN);
        document.getElementById("loginOut").addEventListener("click", LogOff);
        
        function GetCurrentUser() {
            var xmlhttp = new XMLHttpRequest();
            xmlhttp.open("POST", "/api/Account/isAuthenticated", true);
            xmlhttp.onreadystatechange = function () {
                var myObj = "";
                myObj = xmlhttp.responseText != "" ? JSON.parse(xmlhttp.responseText) : {};
                document.getElementById("msgAuth").innerHTML = myObj.message;
            }
            xmlhttp.send();
        }
        function GetCurrentId() {
            var xmlhttp = new XMLHttpRequest();
            xmlhttp.open("POST", "/api/Account/isAuthenticatedId", true);
            xmlhttp.onreadystatechange = function () {
                var myObj = "";
                myObj = xmlhttp.responseText != "" ? JSON.parse(xmlhttp.responseText) : {};
                document.getElementById("profileId").innerHTML = myObj.message;
            }
            xmlhttp.send();
        }

        function ParseResponseMsg() {
            // Считывание данных с формы
            email = document.getElementById("Email").value;
            password = document.getElementById("Password").value;
            var xmlhttp = new XMLHttpRequest();
            xmlhttp.open("POST", "/api/Account/Login");
            xmlhttp.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
            xmlhttp.onreadystatechange = function () {
                // Очистка контейнера вывода сообщений
                document.getElementById("msgAuth").innerHTML = ""
                var mydiv = document.getElementById('formError');
                //while (mydiv.firstChild) {
                //    mydiv.removeChild(mydiv.firstChild);
                //}
                // Обработка ответа от сервера
                myObj = JSON.parse(this.responseText);
                document.getElementById("msgAuth").innerHTML = myObj.message;
                // Вывод сообщений об ошибках
                //if (typeof myObj.error !== "undefined" && myObj.error.length > 0) {
                //    for (var i = 0; i < myObj.error.length; i++) {
                //        var ul = document.getElementsByTagName("ul");
                //        var li = document.createElement("li");
                //        li.appendChild(document.createTextNode(myObj.error[i]));
                //        ul[0].appendChild(li);
                //    }
                //}
                document.getElementById("Password").value = "";

            };
            // Запрос на сервер
            xmlhttp.send(JSON.stringify({
                email: email,
                password: password
            }));
        };

        document.getElementById("loginBtn").addEventListener("click", ParseResponseMsg);

        GetCurrentUser();
        GetCurrentId();
    </script>

    <script>
        function AddToCart(id) {
            var xmlhttp = new XMLHttpRequest();
            xmlhttp.open("POST", "/api/Order/" + document.getElementById("profileId").innerHTML + id, true);
            xmlhttp.onreadystatechange = function () {
                //var myObj = "";
                //myObj = xmlhttp.responseText != "" ? JSON.parse(xmlhttp.responseText) : {};
                //document.getElementById("profileId").innerHTML = myObj.message;
            }
            xmlhttp.send();
        }
    </script>
</body>
</html>